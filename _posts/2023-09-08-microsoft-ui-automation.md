---
title: Microsoft UI Automation Framework - íŠ¸ë¦¬ êµ¬ì¡°ë¡œ UI ìë™í™”ì˜ ì„¸ê³„ë¥¼ íƒí—˜í•˜ë‹¤!
subtitle: .NET ì‹œë¦¬ì¦ˆ
readtime: 10 min
author: wookshin
tags: [dotnet]
comments: true
---

<br/>

# Microsoft UI Automation Framework: íŠ¸ë¦¬ êµ¬ì¡°ë¡œ UI ìë™í™”ì˜ ì„¸ê³„ë¥¼ íƒí—˜í•˜ë‹¤!

ì•ˆë…•í•˜ì„¸ìš”, ì—¬ëŸ¬ë¶„! 

ì™ ì§€ ëª¨ë¥´ê²Œ ìˆ˜ë™ìœ¼ë¡œ í•˜ëŠ” ì¼ë“¤ì´ ë„ˆë¬´ ê·€ì°®ì•„ì§€ëŠ” ê·¸ëŸ° ë‚ ì´ ìˆì£ ? 

ê·¸ëŸ° ë‹¹ì‹ ì„ ìœ„í•´ ìë™í™”ì˜ ì‹ ì„¸ê³„ë¥¼ ì—´ì–´ì¤„ ë†€ë¼ìš´ í”„ë ˆì„ì›Œí¬ë¥¼ ì†Œê°œí•˜ë ¤ê³  í•©ë‹ˆë‹¤. 

ë°”ë¡œ Microsoftì˜ UI Automation Frameworkì…ë‹ˆë‹¤. 

ë³µì¡í•œ ì½”ë“œë‚˜ ë³„ë„ì˜ ë¼ì´ë¸ŒëŸ¬ë¦¬ ì—†ì´ë„ ìœˆë„ìš° ì‘ìš© í”„ë¡œê·¸ë¨ì„ ë§ˆìŒê» ì¡°ì¢…í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. 

ì–´ë–»ê²Œ ê°€ëŠ¥í•œì§€ í•¨ê»˜ ì•Œì•„ë´ìš”.

<br/><br/>

## 1. UI Automation Framework ì´í•´í•˜ê¸°

UI Automation FrameworkëŠ” ì‚¬ìš©ì ì¸í„°í˜ì´ìŠ¤ë¥¼ ìë™í™”í•  ìˆ˜ ìˆë„ë¡ ë„ì™€ì£¼ëŠ” ë¼ì´ë¸ŒëŸ¬ë¦¬ì…ë‹ˆë‹¤. 

ì´ê²ƒì€ ë‹¨ìˆœíˆ ë§ˆìš°ìŠ¤ í´ë¦­ì´ë‚˜ í‚¤ë³´ë“œ ì…ë ¥ì„ í”„ë¡œê·¸ë˜ë° ë°©ì‹ìœ¼ë¡œ ì œì–´í•  ìˆ˜ ìˆê²Œ í•´ì£¼ëŠ” ê²ƒ ë¿ë§Œ ì•„ë‹ˆë¼, ì‚¬ìš©ì ì¸í„°í˜ì´ìŠ¤ì˜ êµ¬ì„± ìš”ì†Œë¥¼ ì½ì„ ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤.

<br/>

### í•µì‹¬ ê°œë…ë“¤

#### **Automation Element**
ì´ê²ƒì€ ì‚¬ìš©ì ì¸í„°í˜ì´ìŠ¤ì˜ êµ¬ì„± ìš”ì†Œë¥¼ ë‚˜íƒ€ëƒ…ë‹ˆë‹¤. ë²„íŠ¼ í•˜ë‚˜ë„, ë˜ëŠ” ì „ì²´ ì‘ìš© í”„ë¡œê·¸ë¨ ì°½ë„ ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

<br/>

#### **Control Patterns**
ì´ëŠ” UI êµ¬ì„± ìš”ì†Œë¥¼ ë¶„ë¥˜í•˜ê³  ì œì–´í•˜ëŠ” ë° ì‚¬ìš©ë©ë‹ˆë‹¤. ì˜ˆë¥¼ ë“¤ì–´, ë²„íŠ¼ê³¼ ì²´í¬ë°•ìŠ¤ëŠ” `InvokePattern`ì„ ì§€ì›í•˜ì—¬ í”„ë¡œê·¸ë˜ë° ë°©ì‹ìœ¼ë¡œ 'í´ë¦­'í•  ìˆ˜ ìˆê²Œ í•´ì¤ë‹ˆë‹¤.

<br/>

#### **Tree Walker**
ì´ê²ƒì€ UI Automation íŠ¸ë¦¬ êµ¬ì¡°ë¥¼ ìˆœíšŒí•  ìˆ˜ ìˆê²Œ í•´ì£¼ëŠ” ê°ì²´ì…ë‹ˆë‹¤.

<br/>

#### **Tree Scope**
ì´ê²ƒì€ íŠ¹ì • automation elementì—ì„œ ì‹œì‘í•˜ëŠ” í•˜ìœ„ íŠ¸ë¦¬ì˜ ë²”ìœ„ë¥¼ ì„¤ëª…í•©ë‹ˆë‹¤.

<br/><br/>

## 2. UI Automation íŠ¸ë¦¬ êµ¬ì¡°

UI Automation íŠ¸ë¦¬ êµ¬ì¡°ë¥¼ ê°„ë‹¨í•˜ê²Œ ì‹œê°í™”í•˜ë©´ ì•„ë˜ì™€ ê°™ì´ ë‚˜íƒ€ë‚¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

```
                        [RootElement]
                               |
                  -----------------------------
                 |               |             |
         [Application 1]   [Application 2] [Application 3]
                 |               |             |
            ---------       ------------    -------------
           |        |      |     |     |    |     |      |  
       [Button] [Label] [Button][Text][Label][Menu][Button]  
           |                                          |
        -------                                    -------
       |       |                                  |       |
    [Text]  [Image]                            [Item1]  [Item2]
```

- **RootElement**: UI Automation íŠ¸ë¦¬ì˜ ë£¨íŠ¸ ìš”ì†Œì…ë‹ˆë‹¤. ëª¨ë“  UI ìš”ì†ŒëŠ” ì´ ë£¨íŠ¸ ìš”ì†Œ ì•„ë˜ì— ìœ„ì¹˜í•©ë‹ˆë‹¤.
- **Application 1, 2, 3**: ì‹¤í–‰ ì¤‘ì¸ ê° ì• í”Œë¦¬ì¼€ì´ì…˜ì˜ ìµœìƒìœ„ UI ìš”ì†Œì…ë‹ˆë‹¤.
- **Button, Label, Text, Menu, Item1, Item2**: ê° ì• í”Œë¦¬ì¼€ì´ì…˜ ë‚´ì˜ UI ìš”ì†Œë“¤ì„ ë‚˜íƒ€ëƒ…ë‹ˆë‹¤.

<br/>

### í•µì‹¬ ê°œë…ë“¤

#### ì»¨íŠ¸ë¡¤ë·° (Control View)
ì´ ë·°ì—ì„œëŠ” `Button`, `Menu`, `Item1`, `Item2`ì™€ ê°™ì´ ì‚¬ìš©ìì™€ ìƒí˜¸ì‘ìš©í•  ìˆ˜ ìˆëŠ” UI ìš”ì†Œë§Œ ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

<br/>

#### ì»¨í…íŠ¸ë·° (Content View)
ì´ ë·°ì—ì„œëŠ” `Text`, `Label`, `Item1`, `Item2`ì™€ ê°™ì´ ì‚¬ìš©ìì—ê²Œ ì •ë³´ë¥¼ í‘œì‹œí•˜ëŠ” ìš”ì†Œë§Œì„ ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

<br/>

#### ë¡œìš°ë·° (Raw View)
ì´ ë·°ì—ì„œëŠ” íŠ¸ë¦¬ì˜ ëª¨ë“  ìš”ì†Œë¥¼ ë³¼ ìˆ˜ ìˆìœ¼ë¯€ë¡œ, ìœ„ì— í‘œí˜„í•œ ëª¨ë“  ë…¸ë“œê°€ í¬í•¨ë©ë‹ˆë‹¤. ì´ ë·°ëŠ” ëª¨ë“  UI ìš”ì†Œë¥¼ í¬í•¨í•˜ê³  ìˆì–´, ê°€ì¥ ì„¸ë°€í•œ ë‹¨ìœ„ì˜ ì‘ì—…ì´ ê°€ëŠ¥í•©ë‹ˆë‹¤. ë‹¨, ì´ ë·°ëŠ” ì¼ë°˜ì ì¸ ìƒí˜¸ì‘ìš©ì—ëŠ” ì‚¬ìš©ë˜ì§€ ì•ŠìŠµë‹ˆë‹¤.

<br/>

ì½”ë“œë¥¼ í†µí•´ ì´ëŸ¬í•œ íŠ¸ë¦¬ êµ¬ì¡°ë¥¼ íƒìƒ‰í•˜ê²Œ ë˜ë©´, ì›í•˜ëŠ” UI ìš”ì†Œë¥¼ ì°¾ì•„ ê·¸ê²ƒê³¼ ìƒí˜¸ì‘ìš©í•˜ëŠ” ê²ƒì´ ê°€ëŠ¥í•©ë‹ˆë‹¤. 

ì´ëŠ” ë³µì¡í•œ ìë™í™” ì‘ì—…ì—ì„œ ì•„ì£¼ ì¤‘ìš”í•œ ê¸°ëŠ¥ì…ë‹ˆë‹¤.

<br/><br/>

## 3. ì˜ˆì œ ì½”ë“œë“¤

#### ì˜ˆì œ ì½”ë“œ 1: ë…¸íŠ¸íŒ¨ë“œ ì—´ê³  í…ìŠ¤íŠ¸ ì…ë ¥í•˜ê¸°

ë¨¼ì €, ë…¸íŠ¸íŒ¨ë“œë¥¼ ìë™ìœ¼ë¡œ ì—´ê³  "Hello, World!"ë¼ê³  ì…ë ¥í•´ë³´ê² ìŠµë‹ˆë‹¤.

```csharp
using System;
using System.Diagnostics;
using System.Threading;
using System.Windows.Automation;

namespace RPAMagic
{
    class Program
    {
        static void Main(string[] args)
        {
            // ë…¸íŠ¸íŒ¨ë“œ ì‹¤í–‰
            Process.Start("notepad.exe");

            // ì•½ê°„ì˜ ëŒ€ê¸° ì‹œê°„
            Thread.Sleep(2000);

            // ë…¸íŠ¸íŒ¨ë“œ ì°½ì„ ì°¾ìŠµë‹ˆë‹¤.
            AutomationElement notepad = AutomationElement.RootElement.FindFirst(TreeScope.Children, new PropertyCondition(AutomationElement.NameProperty, "Untitled - Notepad"));

            // í…ìŠ¤íŠ¸ ì…ë ¥
            SendKeys("Hello, World!");

            // SendKeys ë©”ì†Œë“œ
            static void SendKeys(string keys)
            {
                System.Windows.Forms.SendKeys.SendWait(keys);
            }
        }
    }
}
```

<br/>

#### ì˜ˆì œ ì½”ë“œ 2: ê³„ì‚°ê¸° ì•±ìœ¼ë¡œ ê³„ì‚°í•˜ê¸°

```csharp
// ... (ê¸°ì¡´ using ë¬¸ì¥ë“¤)
using System.Windows.Automation;

// ...

// ê³„ì‚°ê¸° ì‹¤í–‰
Process.Start("calc.exe");
Thread.Sleep(1000);  // ëŒ€ê¸°

// ê³„ì‚°ê¸° ì°½ ì°¾ê¸°
AutomationElement calcWindow = AutomationElement.RootElement.FindFirst(TreeScope.Children, new PropertyCondition(AutomationElement.NameProperty, "Calculator"));

// "1" ë²„íŠ¼ ì°¾ê¸°
AutomationElement button1 = calcWindow.FindFirst(TreeScope.Descendants, new PropertyCondition(AutomationElement.NameProperty, "1"));

// ë²„íŠ¼ í´ë¦­
InvokePattern invokePattern = button1.GetCurrentPattern(InvokePattern.Pattern) as InvokePattern;
invokePattern.Invoke();
```

<br/>

#### ì˜ˆì œ ì½”ë“œ 3: íŒŒì¼ íƒìƒ‰ê¸°ì—ì„œ í´ë” ì—´ê¸°

```csharp
// ... (ê¸°ì¡´ using ë¬¸ì¥ë“¤)
using System.Windows.Automation;

// ...

// íŒŒì¼ íƒìƒ‰ê¸° ì‹¤í–‰
Process.Start("explorer.exe");
Thread.Sleep(2000);  // ëŒ€ê¸°

// íŒŒì¼ íƒìƒ‰ê¸° ì°½ ì°¾ê¸°
AutomationElement explorerWindow = AutomationElement.RootElement.FindFirst(TreeScope.Children, new PropertyCondition(AutomationElement.NameProperty, "File Explorer"));

// ì£¼ì†Œì°½ ì°¾ê¸°
AutomationElement addressBar = explorerWindow.FindFirst(TreeScope.Descendants, new PropertyCondition(AutomationElement.AutomationIdProperty, "addressBar"));

// ì£¼ì†Œì°½ì— í…ìŠ¤íŠ¸ ì…ë ¥
ValuePattern valuePattern = addressBar.GetCurrentPattern(ValuePattern.Pattern) as ValuePattern;
valuePattern.SetValue("C:\\Users");
```

<br/>

#### ì˜ˆì œ ì½”ë“œ 4: TreeWalkerë¡œ ëª¨ë“  ìì‹ ìš”ì†Œ íƒìƒ‰í•˜ê¸°

```csharp
using System;
using System.Windows.Automation;

namespace TreeWalkingExample
{
    class Program
    {
        static void Main(string[] args)
        {
            AutomationElement rootElement = AutomationElement.RootElement;
            TreeWalker walker = TreeWalker.ControlViewWalker;
            WalkTheTree(walker, rootElement);
        }

        static void WalkTheTree(TreeWalker walker, AutomationElement element)
        {
            AutomationElement childElement = walker.GetFirstChild(element);
            while (childElement != null)
            {
                Console.WriteLine(childElement.Current.Name);
                WalkTheTree(walker, childElement);
                childElement = walker.GetNextSibling(childElement);
            }
        }
    }
}
```

ì´ ì½”ë“œëŠ” Control View ê¸°ë°˜ìœ¼ë¡œ ë§Œë“  TreeWalker ê°ì²´ë¥¼ ì‚¬ìš©í•˜ì—¬, UI Automation Treeì˜ ëª¨ë“  ìì‹ ìš”ì†Œë¥¼ ì¬ê·€ì ìœ¼ë¡œ íƒìƒ‰í•˜ê³  ì¶œë ¥í•©ë‹ˆë‹¤.

<br/>

#### ì˜ˆì œ ì½”ë“œ 5: íŠ¹ì • í”„ë¡œê·¸ë¨ì˜ UI ìš”ì†Œë§Œ íƒìƒ‰í•˜ê¸°

```csharp
AutomationElement targetProgram = AutomationElement.RootElement.FindFirst(TreeScope.Children, new PropertyCondition(AutomationElement.NameProperty, "Your Program Name"));
TreeWalker walker = TreeWalker.ControlViewWalker;
WalkTheTree(walker, targetProgram);
```

ì´ë ‡ê²Œí•˜ë©´ íŠ¹ì • í”„ë¡œê·¸ë¨ì˜ UI ìš”ì†Œë§Œì„ ëŒ€ìƒìœ¼ë¡œ Treeë¥¼ íƒìƒ‰í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

<br/><br/>

## 4. ë§ˆë¬´ë¦¬

ì´ë ‡ê²Œí•˜ë©´ íŠ¹ì • í”„ë¡œê·¸ë¨ì˜ UI ìš”ì†Œë§Œì„ ëŒ€ìƒìœ¼ë¡œ Treeë¥¼ íƒìƒ‰í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

ë‹¨ìˆœíˆ ë²„íŠ¼ì„ í´ë¦­í•˜ê±°ë‚˜ í…ìŠ¤íŠ¸ë¥¼ ì…ë ¥í•˜ëŠ” ê²ƒì—ì„œ ê·¸ì¹˜ì§€ ì•Šê³ , íŠ¸ë¦¬ êµ¬ì¡°ë¥¼ ì´í•´í•˜ê³  ì´ë¥¼ í™œìš©í•˜ë©´ ë”ìš± ë‹¤ì–‘í•˜ê³  ë³µì¡í•œ ì‘ì—…ì„ ìë™í™”í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

ë§¤ìš° í¥ë¯¸ë¡­ì§€ ì•Šë‚˜ìš”? ë‹¹ì‹ ì´ ì§€ë£¨í•œ ì¼ìƒì—ì„œ ë²—ì–´ë‚˜ ìƒˆë¡œìš´ ê°€ëŠ¥ì„±ì„ ì°¾ì„ ìˆ˜ ìˆê¸°ë¥¼ ë°”ëë‹ˆë‹¤. 

ë‹¤ìŒì— ë˜ ëµ™ê² ìŠµë‹ˆë‹¤! ğŸš€

<br/><br/><br/><br/><br/>
